{
  "id": "emergent-leader",
  "name": "Emergent Leader",
  "category": "Distributed Systems",
  "description": "A pattern where leadership emerges naturally from peer interactions rather than being assigned",
  "when_to_use": "Peer-to-peer systems, decentralized coordination, fault-tolerant systems",
  "benefits": "No single point of failure, automatic failover, decentralized control",
  "drawbacks": "Potential for conflicts, slower decision making, complex implementation",
  "use_cases": "Blockchain networks, peer-to-peer file sharing, distributed databases",
  "complexity": "High",
  "tags": ["distributed-systems", "leadership", "peer-to-peer", "consensus"],
  "examples": {
    "typescript": {
      "language": "typescript",
      "code": "interface Node {\n  id: string;\n  heartbeat(): Promise<void>;\n  isAlive(): boolean;\n}\n\nclass EmergentLeader {\n  private nodes: Map<string, Node> = new Map();\n  private leaderId: string | null = null;\n  private term = 0;\n  private votes: Map<string, string> = new Map();\n  \n  addNode(node: Node) {\n    this.nodes.set(node.id, node);\n  }\n  \n  async electLeader(): Promise<string | null> {\n    this.term++;\n    this.votes.clear();\n    this.leaderId = null;\n    \n    // Request votes from all nodes\n    const votePromises = Array.from(this.nodes.values())\n      .filter(node => node.isAlive())\n      .map(node => this.requestVote(node));\n    \n    await Promise.allSettled(votePromises);\n    \n    // Count votes\n    const voteCounts = new Map<string, number>();\n    for (const [voterId, candidateId] of this.votes) {\n      voteCounts.set(candidateId, (voteCounts.get(candidateId) || 0) + 1);\n    }\n    \n    // Find candidate with majority\n    const majority = Math.floor(this.nodes.size / 2) + 1;\n    for (const [candidateId, count] of voteCounts) {\n      if (count >= majority) {\n        this.leaderId = candidateId;\n        this.broadcastLeaderElection(candidateId);\n        return candidateId;\n      }\n    }\n    \n    return null; // No leader elected\n  }\n  \n  private async requestVote(node: Node): Promise<void> {\n    try {\n      // In a real implementation, this would be a network call\n      const voteGranted = await this.simulateVoteRequest(node);\n      if (voteGranted) {\n        this.votes.set(node.id, node.id); // Vote for self in this simple example\n      }\n    } catch (error) {\n      console.error(`Failed to get vote from ${node.id}:`, error);\n    }\n  }\n  \n  private async simulateVoteRequest(node: Node): Promise<boolean> {\n    // Simulate network delay and potential failure\n    await new Promise(resolve => setTimeout(resolve, Math.random() * 100));\n    return Math.random() > 0.2; // 80% success rate\n  }\n  \n  private broadcastLeaderElection(leaderId: string) {\n    // Notify all nodes of the new leader\n    for (const node of this.nodes.values()) {\n      if (node.isAlive()) {\n        this.notifyNodeOfLeader(node, leaderId);\n      }\n    }\n  }\n  \n  private notifyNodeOfLeader(node: Node, leaderId: string) {\n    // In a real system, this would send a network message\n    console.log(`Notifying ${node.id} that ${leaderId} is the leader`);\n  }\n  \n  getCurrentLeader(): string | null {\n    return this.leaderId;\n  }\n  \n  async monitorLeadership() {\n    setInterval(async () => {\n      if (!this.leaderId || !this.nodes.get(this.leaderId)?.isAlive()) {\n        console.log('Leader is down, starting new election');\n        await this.electLeader();\n      }\n    }, 5000);\n  }\n}\n\n// Usage\nconst leaderElection = new EmergentLeader();\n\n// Add nodes\nleaderElection.addNode({ \n  id: 'node1', \n  heartbeat: async () => {}, \n  isAlive: () => true \n});\nleaderElection.addNode({ \n  id: 'node2', \n  heartbeat: async () => {}, \n  isAlive: () => true \n});\nleaderElection.addNode({ \n  id: 'node3', \n  heartbeat: async () => {}, \n  isAlive: () => true \n});\n\n// Start monitoring\nleaderElection.monitorLeadership();\n\n// Initial election\nleaderElection.electLeader().then(leader => {\n  console.log(`Elected leader: ${leader}`);\n});"
    }
  }
}
